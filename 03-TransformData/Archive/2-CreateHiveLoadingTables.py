# Databricks notebook source
# MAGIC %run ../01-General/0-Mount_Indigo_Blob

# COMMAND ----------

MOUNTPOINT = "/mnt/Blankets_model"
SourcePath = MOUNTPOINT + "/azureml/Blankets_model"
RawPath = SourcePath + "/Dev/Raw"
ResearchPath = SourcePath + "/Dev/Research"
LandingPath = SourcePath + "/Dev/Landing"
LoadingPath = SourcePath + "/Dev/Loading"
certified_pit = SourcePath + "/Dev/certified-pit"
display(dbutils.fs.ls(LoadingPath))

# COMMAND ----------

# MAGIC %md
# MAGIC ### parameters_run_level_pivot

# COMMAND ----------

# MAGIC %sql
# MAGIC USE BLANKETS_DB;
# MAGIC DROP TABLE IF EXISTS blankets_db.ld_parameters_run_level_pivot;
# MAGIC CREATE TABLE IF NOT EXISTS blankets_db.ld_parameters_run_level_pivot (
# MAGIC  
# MAGIC   Batch STRING,
# MAGIC   BODY_DIAMETER_SP_Mean DOUBLE,
# MAGIC   BODY_DIAMETER_SP_stdev DOUBLE,
# MAGIC   BODY_SEAM_COUNTS_Mean DOUBLE,
# MAGIC   BODY_SEAM_COUNTS_stdev DOUBLE,
# MAGIC   BODY_UNWIND_DIAMETER_FDBK_Mean DOUBLE,
# MAGIC   BODY_UNWIND_DIAMETER_FDBK_stdev DOUBLE,
# MAGIC   CONVEYOR_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CONVEYOR_SPEED_FDBK_stdev DOUBLE,
# MAGIC   COOLING_PLATE_CHILLER_TEMP_FB_Mean DOUBLE,
# MAGIC   COOLING_PLATE_CHILLER_TEMP_FB_stdev DOUBLE,
# MAGIC   COOLING_PLATE_WEB_TEMP_FB_Mean DOUBLE,
# MAGIC   COOLING_PLATE_WEB_TEMP_FB_stdev DOUBLE,
# MAGIC   CSL_DIAMETER_SP_Mean DOUBLE,
# MAGIC   CSL_DIAMETER_SP_stdev DOUBLE,
# MAGIC   CSL_SUPP_SEAM_COUNTS_Mean DOUBLE,
# MAGIC   CSL_SUPP_SEAM_COUNTS_stdev DOUBLE,
# MAGIC   CSL_UNWIND_DIAMETER_FDBK_Mean DOUBLE,
# MAGIC   CSL_UNWIND_DIAMETER_FDBK_stdev DOUBLE,
# MAGIC   CTR_1_GRVR_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CTR_1_GRVR_SPEED_FDBK_stdev DOUBLE,
# MAGIC   CTR_2_AIR_FLOW_Mean DOUBLE,
# MAGIC   CTR_2_AIR_FLOW_stdev DOUBLE,
# MAGIC   CTR_2_BCKNG_ROLL_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CTR_2_BCKNG_ROLL_SPEED_FDBK_stdev DOUBLE,
# MAGIC   CTR_2_BCKNG_TEN_FB_Mean DOUBLE,
# MAGIC   CTR_2_BCKNG_TEN_FB_stdev DOUBLE,
# MAGIC   CTR_2_DS_GAP_MM_Mean DOUBLE,
# MAGIC   CTR_2_DS_GAP_MM_stdev DOUBLE,
# MAGIC   `CTR_2_DS_GAP_with_I2P_Mean` DOUBLE,
# MAGIC   `CTR_2_DS_GAP_with_I2P_stdev` DOUBLE,
# MAGIC   CTR_2_GRVR_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CTR_2_GRVR_SPEED_FDBK_stdev DOUBLE,
# MAGIC   CTR_2_OS_GAP_MM_Mean DOUBLE,
# MAGIC   CTR_2_OS_GAP_MM_stdev DOUBLE,
# MAGIC   `CTR_2_OS_GAP_with_I2P_Mean` DOUBLE,
# MAGIC   `CTR_2_OS_GAP_with_I2P_stdev` DOUBLE,
# MAGIC   CTR_2_PUMP_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CTR_2_PUMP_SPEED_FDBK_stdev DOUBLE,
# MAGIC   CTR_3_AIR_FLOW_Mean DOUBLE,
# MAGIC   CTR_3_AIR_FLOW_stdev DOUBLE,
# MAGIC   CTR_3_BCKNG_ROLL_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CTR_3_BCKNG_ROLL_SPEED_FDBK_stdev DOUBLE,
# MAGIC   CTR_3_BCKNG_TEN_FB_Mean DOUBLE,
# MAGIC   CTR_3_BCKNG_TEN_FB_stdev DOUBLE,
# MAGIC   CTR_3_DS_GAP_MM_Mean DOUBLE,
# MAGIC   CTR_3_DS_GAP_MM_stdev DOUBLE,
# MAGIC   `CTR_3_DS_GAP_with_I2P_Mean` DOUBLE,
# MAGIC   `CTR_3_DS_GAP_with_I2P_stdev` DOUBLE,
# MAGIC   CTR_3_GRVR_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CTR_3_GRVR_SPEED_FDBK_stdev DOUBLE,
# MAGIC   CTR_3_OS_GAP_MM_Mean DOUBLE,
# MAGIC   CTR_3_OS_GAP_MM_stdev DOUBLE,
# MAGIC   `CTR_3_OS_GAP_with_I2P_Mean` DOUBLE,
# MAGIC   `CTR_3_OS_GAP_with_I2P_stdev` DOUBLE,
# MAGIC   CTR_3_PUMP_SPEED_FDBK_Mean DOUBLE,
# MAGIC   CTR_3_PUMP_SPEED_FDBK_stdev DOUBLE,
# MAGIC   CTR_4_BCKNG_TEN_FB_Mean DOUBLE,
# MAGIC   CTR_4_BCKNG_TEN_FB_stdev DOUBLE,
# MAGIC   CTR_4_XFR_ROLL_TORQUE_SP_Mean DOUBLE,
# MAGIC   DRYER_EXHAUST_SPEED_FDBK_Mean DOUBLE,
# MAGIC   DRYER_EXHAUST_SPEED_FDBK_stdev DOUBLE,
# MAGIC   DR_1_AIR_TEMP_FB_Mean DOUBLE,
# MAGIC   DR_1_AIR_TEMP_FB_stdev DOUBLE,
# MAGIC   DR_1_VELOCITY_FB_Mean DOUBLE,
# MAGIC   DR_1_VELOCITY_FB_stdev DOUBLE,
# MAGIC   DR_2_AIR_TEMP_FB_Mean DOUBLE,
# MAGIC   DR_2_AIR_TEMP_FB_stdev DOUBLE,
# MAGIC   DR_2_VELOCITY_FB_Mean DOUBLE,
# MAGIC   DR_2_VELOCITY_FB_stdev DOUBLE,
# MAGIC   DR_3_AIR_TEMP_FB_Mean DOUBLE,
# MAGIC   DR_3_AIR_TEMP_FB_stdev DOUBLE,
# MAGIC   DR_3_VELOCITY_FB_Mean DOUBLE,
# MAGIC   DR_3_VELOCITY_FB_stdev DOUBLE,
# MAGIC   DR_4_AIR_TEMP_FB_Mean DOUBLE,
# MAGIC   DR_4_AIR_TEMP_FB_stdev DOUBLE,
# MAGIC   DR_4_VELOCITY_FB_Mean DOUBLE,
# MAGIC   DR_4_VELOCITY_FB_stdev DOUBLE,
# MAGIC   DR_AIR_TEMP_FB_Mean DOUBLE,
# MAGIC   DR_AIR_TEMP_FB_stdev DOUBLE,
# MAGIC   DR_WEB_TEMP_FB_Mean DOUBLE,
# MAGIC   DR_WEB_TEMP_FB_stdev DOUBLE,
# MAGIC   IR1_Mean DOUBLE,
# MAGIC   IR1_stdev DOUBLE,
# MAGIC   IR2_Mean DOUBLE,
# MAGIC   IR2_stdev DOUBLE,
# MAGIC   IR3_Mean DOUBLE,
# MAGIC   IR3_stdev DOUBLE,
# MAGIC   IR4_Mean DOUBLE,
# MAGIC   IR4_stdev DOUBLE,
# MAGIC   IR5_Mean DOUBLE,
# MAGIC   IR5_stdev DOUBLE,
# MAGIC   `ITM-R_SPEED_FDBK_Mean` DOUBLE,
# MAGIC   `ITM-R_SPEED_FDBK_stdev` DOUBLE,
# MAGIC   `ITM-R_TEMP_FB_Mean` DOUBLE,
# MAGIC   `ITM-R_TEMP_FB_stdev` DOUBLE,
# MAGIC   `ITM_R ROLL_TORQUE_FDBK_Mean` DOUBLE,
# MAGIC   `ITM_R ROLL_TORQUE_FDBK_stdev` DOUBLE,
# MAGIC   LAMINATOR_NIP_PRESSURE_FB_Mean DOUBLE,
# MAGIC   LAMINATOR_NIP_PRESSURE_FB_stdev DOUBLE,
# MAGIC   LAMINATOR_OIL_TEMP_FB_Mean DOUBLE,
# MAGIC   LAMINATOR_OIL_TEMP_FB_stdev DOUBLE,
# MAGIC   LAMINATOR_SPEED_FDBK_Mean DOUBLE,
# MAGIC   LAMINATOR_SPEED_FDBK_stdev DOUBLE,
# MAGIC   LAMINATOR_TEMP_FB_Mean DOUBLE,
# MAGIC   LAMINATOR_TEMP_FB_stdev DOUBLE,
# MAGIC   LAMINATOR_TORQUE_FDB_Mean DOUBLE,
# MAGIC   LAMINATOR_TORQUE_FDB_stdev DOUBLE,
# MAGIC   LAMINATOR_WEB_TEMP_FB_Mean DOUBLE,
# MAGIC   LAMINATOR_WEB_TEMP_FB_stdev DOUBLE,
# MAGIC   LINE_SPEED_FB_Mean DOUBLE,
# MAGIC   LINE_SPEED_FB_stdev DOUBLE,
# MAGIC   OFFSET_TRANSFER_ROLL_SPEED_RATION_FDBK_Mean DOUBLE,
# MAGIC   OFFSET_TRANSFER_ROLL_SPEED_RATION_FDBK_stdev DOUBLE,
# MAGIC   OFFSET_TRANSFER_ROLL_TORQUE_FDBK_Mean DOUBLE,
# MAGIC   OFFSET_TRANSFER_ROLL_TORQUE_FDBK_stdev DOUBLE,
# MAGIC   PREHEAT_ROLL_SPEED_FDBK_Mean DOUBLE,
# MAGIC   PREHEAT_ROLL_SPEED_FDBK_stdev DOUBLE,
# MAGIC   PREHEAT_ROLL_TORQUE_FDBK_Mean DOUBLE,
# MAGIC   PREHEAT_ROLL_TORQUE_FDBK_stdev DOUBLE,
# MAGIC   PRIMER_GR_ROLL_TORQUE_FDBK_Mean DOUBLE,
# MAGIC   PRIMER_GR_ROLL_TORQUE_FDBK_stdev DOUBLE,
# MAGIC   RELEASE_GR_ROLL_TORQUE_FDBK_Mean DOUBLE,
# MAGIC   RELEASE_GR_ROLL_TORQUE_FDBK_stdev DOUBLE,
# MAGIC   SCRAP_WNDR_1_SPEED_FDBK_Mean DOUBLE,
# MAGIC   SCRAP_WNDR_1_SPEED_FDBK_stdev DOUBLE,
# MAGIC   SCRAP_WNDR_1_TORQUE_FDBK_Mean DOUBLE,
# MAGIC   SCRAP_WNDR_1_TORQUE_FDBK_stdev DOUBLE,
# MAGIC   SCRAP_WNDR_1_TORQUE_Mean DOUBLE,
# MAGIC   SCRAP_WNDR_1_TORQUE_stdev DOUBLE,
# MAGIC   SCRAP_WNDR_2_SPEED_FDBK_Mean DOUBLE,
# MAGIC   SCRAP_WNDR_2_SPEED_FDBK_stdev DOUBLE,
# MAGIC   SCRAP_WNDR_2_TORQUE_FDBK_Mean DOUBLE,
# MAGIC   SCRAP_WNDR_2_TORQUE_FDBK_stdev DOUBLE,
# MAGIC   SCRAP_WNDR_2_TORQUE_Mean DOUBLE,
# MAGIC   SCRAP_WNDR_2_TORQUE_stdev DOUBLE,
# MAGIC   SCRAP_WNDR_3_SPEED_FDBK_Mean DOUBLE,
# MAGIC   SCRAP_WNDR_3_SPEED_FDBK_stdev DOUBLE,
# MAGIC   `SCRAP_WNDR_3_TORQUE(name_edited)_Mean` DOUBLE,
# MAGIC   `SCRAP_WNDR_3_TORQUE(name_edited)_stdev` DOUBLE,
# MAGIC   `SCRAP_WNDR_3_TORQUE_FDBK(name_edited)_Mean` DOUBLE,
# MAGIC   `SCRAP_WNDR_3_TORQUE_FDBK(name_edited)_stdev` DOUBLE,
# MAGIC   UNWIND_1_SPEED_FDBK_Mean DOUBLE,
# MAGIC   UNWIND_1_SPEED_FDBK_stdev DOUBLE,
# MAGIC   UNWIND_1_TEN_FB_Mean DOUBLE,
# MAGIC   UNWIND_1_TEN_FB_stdev DOUBLE,
# MAGIC   UNWIND_2_SPEED_FDBK_Mean DOUBLE,
# MAGIC   UNWIND_2_SPEED_FDBK_stdev DOUBLE,
# MAGIC   UNWIND_2_TEN_FB_Mean DOUBLE,
# MAGIC   UNWIND_2_TEN_FB_stdev DOUBLE,
# MAGIC   VACUUM_BELT_FAN_SPEED_FDBK_Mean DOUBLE,
# MAGIC   VACUUM_BELT_FAN_SPEED_FDBK_stdev DOUBLE,
# MAGIC   VACUUM_BELT_SPEED_FDBK_Mean DOUBLE,
# MAGIC   VACUUM_BELT_SPEED_FDBK_stdev DOUBLE,
# MAGIC   VACUUM_BELT_TEN_FB_Mean DOUBLE,
# MAGIC   VACUUM_BELT_TEN_FB_stdev DOUBLE,
# MAGIC   VACUUM_ROLL_2_PRESS_FB_Mean DOUBLE,
# MAGIC   VACUUM_ROLL_2_PRESS_FB_stdev DOUBLE,
# MAGIC   XYLENE_GR_ROLL_TORQUE_FDBK_Mean DOUBLE,
# MAGIC   XYLENE_GR_ROLL_TORQUE_FDBK_stdev DOUBLE)
# MAGIC 
# MAGIC USING parquet
# MAGIC OPTIONS (path "/mnt/Blankets_model/azureml/Blankets_model/Dev/Loading/parameters_run/ld_parameters_run_level_pivot_N");
# MAGIC ANALYZE TABLE parameters_run_level_pivot COMPUTE STATISTICS;

# COMMAND ----------

# MAGIC %md
# MAGIC ### blanket_lifespan_run

# COMMAND ----------

ld_blanket_lifespan_run_df.write.parquet(LoadingPath + "/Blanket_lifespan/ld_blanket_lifespan_run/",mode="overwrite").saveAsTable("TEST")

# COMMAND ----------

# MAGIC %sql
# MAGIC USE BLANKETS_DB;
# MAGIC DROP TABLE IF EXISTS blankets_db.ld_blanket_lifespan_run;
# MAGIC CREATE TABLE IF NOT EXISTS blankets_db.ld_blanket_lifespan_run
# MAGIC USING parquet
# MAGIC OPTIONS (path "/mnt/Blankets_model/azureml/Blankets_model/Dev/Loading/Blanket_lifespan/ld_blanket_lifespan_run");
# MAGIC ANALYZE TABLE ld_blanket_lifespan_run COMPUTE STATISTICS;

# COMMAND ----------

# MAGIC %sql
# MAGIC USE BLANKETS_DB;
# MAGIC DROP TABLE IF EXISTS blankets_db.ld_blanket_lifespan_run;
# MAGIC CREATE TABLE IF NOT EXISTS blankets_db.ld_blanket_lifespan_run
# MAGIC USING parquet
# MAGIC OPTIONS (path "/mnt/Blankets_model/azureml/Blankets_model/Dev/Loading/Blanket_lifespan/ld_blanket_lifespan_run");
# MAGIC ANALYZE TABLE ld_blanket_lifespan_run COMPUTE STATISTICS;